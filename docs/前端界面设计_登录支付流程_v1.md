# 提猫直播助手 · Electron 前端界面设计（登录/支付阶段）

## 1. 技术栈与框架约定
- **桌面壳**：Electron 主进程（`electron/main.js`）负责进程守护、窗口管理、服务启动。
- **前端架构**：引入 Vite + React + TypeScript 至 `electron/renderer`，使用 React Router 管理多页面；组件库选择自定义加 Tailwind（或 styled-components）保持可爱风。
- **状态管理**：Zustand 管理全局状态（用户、支付状态、服务运行状态）。
- **请求层**：通过 `window.electronAPI`（preload 暴露）调用主进程/本地服务 REST；登录/支付先连 mock API，后续替换为 Flask/FastAPI。
- **权限守卫**：在 React Router 层实现 `AuthGuard`，根据登录态和支付审核状态跳转。

## 2. 页面结构
```
App
├── AuthLayout (/auth)
│   ├── LoginPage (/auth/login)
│   ├── RegisterPage (/auth/register)
│   └── ForgotPasswordPage (预留)
├── PaymentLayout (/pay)
│   └── PaymentVerifyPage (/pay/verify)
└── MainLayout (/)
    ├── DashboardPage (/dashboard) – 主控台
    ├── LiveConsolePage (/live) – 实时面板（后续接 AST/Douyin）
    └── ReportsPage (/reports)
```
- 主题切换（粉色/紫色）作为全局样式上下文，沿用 `docs/protype/提猫直播管理平台_可爱原型_multi_theme.html` 的设计变量。

## 3. 登录/注册流程
### 3.1 表单字段
- 邮箱 / 手机号（按后端策略选其一）
- 密码 / 确认密码
- 昵称（注册专用）
- 验证码（预留，当前阶段可选）

### 3.2 交互细节
- 登录成功 → 更新全局 `auth.user`、`auth.token`，跳转支付确认页面。
- 注册成功 → 自动登录或提示去登录（配置项决定）。
- 错误提示统一走 Toast（可爱风小猫气泡）。

### 3.3 Mock API
- `POST /mock/auth/login` → 返回 `{success, token, user, isPaid}`。
- `POST /mock/auth/register` → 返回 `{success, user}`。
- `GET /mock/auth/profile` → 返回最新支付状态。
- Mock 数据临时保存在 `electron/mock` JSON 文件。

## 4. 支付验证流程
### 4.1 页面内容
- 上传微信/支付宝收款截图（JPG/PNG）。
- 输入交易流水号/备注（可选）。
- 提交后进入“待审核”状态显示倒计时。

### 4.2 状态机
```
UNPAID → (上传截图) → PENDING_REVIEW → (人工审核) → APPROVED → 可用
                                            ↘ REJECTED → 重新上传
```
- 当前阶段：上传后模拟后台 5s 内返回通过/拒绝（可配置）。
- 后续接入真实审核接口时，在 Flask/FastAPI 提供 `/api/payment/upload`、`/api/payment/status`。

### 4.3 权限控制
- `isPaid !== true` 时禁止进入 `/dashboard` 等主功能页面，提示跳转 `/pay/verify`。
- Electron 主进程在启动 AST/Douyin 服务前校验支付状态，未通过直接返回错误。

## 5. 主壳页面（占位）
- 顶部导航：用户信息、主题切换、退出登录。
- 侧边导航：Dashboard / 实时面板 / 复盘报告 / 设置。
- 主内容暂放可爱背景 + “功能开发中”占位，后续接入实时功能。

## 6. Electron 集成要点
1. **Preload**：暴露 `electronAPI`，含 `auth`、`payment`、`services` 调用；所有 React 请求走该桥。
2. **主进程**：
   - 维护用户会话（可存储在 `app.getPath('userData')`）。
   - 根据支付状态控制启动 AST/抓取服务的 IPC。
   - 预留 `ipcMain.handle('payment-upload')` 上传接口。
3. **打包**：后续使用 `electron-builder`，现阶段仅开发模式。

## 7. 文件规划
```
electron/
├── main.js
├── preload.js
├── renderer/
│   ├── src/
│   │   ├── App.tsx
│   │   ├── main.tsx
│   │   ├── routes/
│   │   ├── components/
│   │   ├── pages/
│   │   │   ├── auth/
│   │   │   ├── payment/
│   │   │   └── dashboard/
│   │   ├── store/
│   │   ├── hooks/
│   │   └── services/
│   └── index.html (Vite)
└── mock/
    └── auth.json
```

## 8. 后续联调接口
| 模块 | API | 说明 |
| --- | --- | --- |
| Auth | `/api/auth/login` | Flask (待实现) |
| Payment | `/api/payment/upload` | Flask 接收截图/状态 |
| AST | `/api/live_audio/*` | FastAPI，需 auth 校验 |
| Douyin | `/api/douyin/*` | FastAPI，需 auth 校验 |

---
**版本**: v1.0  
**作者**: 产品体验团队  
**日期**: 2025-01-20
