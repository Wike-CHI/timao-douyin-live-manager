# 提猫直播助手启动说明

本文档详细说明了如何启动和运行提猫直播助手Electron应用及其相关服务。

## 系统要求

- Windows 10/11 或 macOS 10.15+ 或 Linux (Ubuntu 20.04+)
- Node.js 16+ 和 npm 8+
- Python 3.8+
- 至少4GB内存

## 目录结构

```
timao-douyin-live-manager/
├── electron/                 # Electron应用主进程和渲染进程
│   ├── main.js              # Electron主进程文件
│   ├── preload.js           # 预加载脚本
│   └── renderer/            # 渲染进程(前端)
├── server/                  # FastAPI后端服务
├── AST_module/              # 语音识别模块
├── docs/                    # 文档
└── start_app.bat            # Windows启动脚本
```

## 端口配置

应用使用以下端口：

- **30013**: Vite开发服务器端口
- **8007**: FastAPI后端服务端口

## 启动步骤

### 1. 安装依赖

在项目根目录下执行：

```bash
# 安装Python依赖
pip install -r requirements.all.txt

# 安装Electron渲染进程依赖
cd electron/renderer
npm install
cd ../..

# 安装Electron主进程依赖
cd electron
npm install
cd ..
```

### 2. 环境变量配置

在项目根目录创建 `.env` 文件，内容如下：

```env
ELECTRON_START_API=true
```

在 `electron/renderer/.env` 文件中确保有：

```env
VITE_FASTAPI_URL=http://127.0.0.1:8007
```

### 3. 启动服务

有两种方式启动应用：

#### 方式一：使用启动脚本（推荐）

```bash
# Windows
start_app.bat

# macOS/Linux
./start_app.sh
```

#### 方式二：手动启动

1. 启动Vite开发服务器：
   ```bash
   cd electron/renderer
   npm run dev
   ```

2. 启动FastAPI服务：
   ```bash
   cd ../..
   python -m uvicorn server.app.main:app --host 127.0.0.1 --port 8007
   ```

3. 启动Electron应用：
   ```bash
   cd electron
   npm start
   ```

### 4. 访问应用

启动完成后，Electron应用窗口将自动打开。您也可以通过浏览器访问以下地址：

- 前端界面: http://127.0.0.1:30013
- API文档: http://127.0.0.1:8007/docs

## 故障排除

### 端口冲突

如果遇到端口冲突错误，请检查以下文件中的端口配置并确保一致性：

1. `electron/main.js` - Electron主进程启动FastAPI的端口
2. `electron/renderer/src/pages/dashboard/LiveConsolePage.tsx` - 前端默认API地址
3. `electron/renderer/.env` - 前端环境变量中的API地址

### 服务无法启动

1. 确保所有依赖已正确安装
2. 检查Python环境是否包含所有必需的包
3. 确认SenseVoice模型文件已正确放置在指定位置

### 其他问题

1. 查看终端输出的错误信息
2. 检查Electron应用控制台日志
3. 确保防火墙未阻止相关端口

## 应用功能

启动成功后，您可以使用以下功能：

1. **音频转写**: 使用SenseVoiceSmall模型进行实时语音转写
2. **抖音直播**: 连接抖音直播间并转发消息
3. **实时字幕**: 显示实时转写结果作为字幕
4. **会话管理**: 管理不同的转写会话

## 停止服务

要停止所有服务，可以：

1. 关闭Electron应用窗口
2. 在终端中按 `Ctrl+C` 停止各服务进程
3. 如果使用启动脚本，关闭脚本窗口即可停止所有服务
