# Todo List (2025-10-12)

## AI 话术工作流

- [ ] 基于 LangChain + LangGraph 重构直播分析链路，让 AI 输出更口语化、人情味、贴近主播风格的建议；每位主播的记忆数据独立存放在各自文件夹，避免交叉干扰。
- [ ] 为话术生成增加“话术窗口”模块，展示 2-3 条推荐用语，支持人工/自动打分；打分结果写入独立的主播话术反馈库，低分话术将用于 LangGraph 过滤避用。
- [ ] 强化话题聚焦和情感陪伴，让 AI 能根据主播当前话题、弹幕热点及时切换节奏并保持暖场。

## AI LangGraph 重构计划

- [ ] 搭建 LangGraph 图：MemoryLoader、SignalCollector、TopicDetector、MoodEstimator、Planner、Summary、MemoryUpdater 等节点，编写伪代码→初稿实现。
- [ ] 实现 MemoryLoader & MemoryUpdater：定义 `records/memory/<主播ID>/` 结构，支持读写 profile/history/feedback，编写同步锁与清理脚本。
- [ ] 编写 TopicDetector & MoodEstimator：整合现有 VAD/弹幕信号，输出话题锚点与情绪标签，补充单元测试。
- [ ] ScriptGenerator 子流程：根据 Planner 路由编写不同 Prompt，输出 2–3 条话术（含 meta 信息），接入 ScoreAssessor。
- [ ] ScoreAssessor + 反馈回写：实现规则/LLM 打分，记录 `good/bad` 话术并暴露 `/api/ai/live/feedback` 接口供前端打分调用。
- [ ] SummaryNode 与 SSE 输出：结构化亮点/风险/建议/话术，保持前端现有 JSON schema。
- [ ] 前端“话术窗口”扩展：展示逻辑 + 打分按钮 + 低分话术记录；调 LangGraph API。
- [ ] 部署与监控：启动前运行 `npm run prepare:torch`、配置 GPU，记录 LangGraph 执行日志到 `records/ai_logs/graph/`，并加入失败告警。

## 质量与反馈

- [ ] 设计低分话术的回收策略（如保存于 `records/ai_feedback/bad_scripts.jsonl`），用于 LangChain/LangGraph 记忆节点过滤。
- [ ] 增加情绪/互动信号监控，必要时提示转场或插入轻松话术，确保直播氛围不“冷”。
