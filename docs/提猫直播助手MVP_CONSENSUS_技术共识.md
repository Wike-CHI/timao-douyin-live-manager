# 提猫直播助手MVP - 技术共识文档

## 技术栈最终对齐

基于F2项目分析和用户需求，最终技术选型：

### 前端桌面端

```yaml
框架: HTML + CSS + Element UI 2.15
交互: 原生JavaScript + WebSocket  
容器: Electron (可选桌面应用)
风格: 可爱猫咪主题 + 圆角设计
```

### 后端服务

```yaml
框架: FastAPI + Python 3.11
数据库: SQLite (轻量级MVP)
缓存: Redis (可选，用于消息队列)
```

### 数据抓取 - F2项目

```yaml
工具: F2 (https://github.com/Johnserf-Seed/f2)
功能: 抖音直播弹幕实时抓取
优势: 
  - 成熟的开源项目，持续维护
  - 完善的WebSocket弹幕抓取API
  - 支持多种消息类型（评论、礼物、点赞等）
  - 已处理抖音反爬机制
集成方式: Python包导入使用
```

### 音频识别 - VOSK

```yaml
引擎: VOSK本地语音识别
模型: vosk-model-cn-0.22 (中文)
输入: 实时麦克风音频流
优势:
  - 本地运行，无API费用
  - 支持中文，识别准确率可接受
  - 轻量级，适合MVP验证
```

### AI分析

```yaml
方案: 本地NLP + 轻量级模型
工具: jieba分词 + SnowNLP情感分析
备选: 如需高级功能可调用deepseek V3.1
```

## 需求描述

### 核心功能

1. **F2直播弹幕抓取**

   - 实时连接抖音直播间
   - 抓取评论、礼物、点赞等消息
   - WebSocket实时推送到前端
2. **VOSK语音转录**

   - 实时录制主播音频
   - 本地转录为文字
   - 与弹幕数据联合分析
3. **本地AI分析**

   - 弹幕情感分析和热词提取
   - 语音内容关键词识别
   - 生成简单的互动建议
4. **Element UI界面**

   - 可爱猫咪风格设计
   - 三区域布局：弹幕流/语音转录/AI建议
   - 实时数据更新

### 验收标准

- [ ] F2成功连接抖音直播间，实时抓取弹幕 (延迟<3秒)
- [ ] VOSK语音识别准确率>80% (中文识别)
- [ ] Element UI界面美观，符合可爱风格要求
- [ ] 3天内完成基础功能，可演示使用

### 技术实现方案

1. **F2集成**：

   - 使用F2的DouyinHandler和WebSocketCrawler
   - 配置游客cookie和WebSocket回调
   - 处理各种消息类型并转发
2. **VOSK集成**：

   - Python集成VOSK库
   - 实时音频流处理
   - 转录结果与弹幕关联
3. **前后端通信**：

   - WebSocket实时数据推送
   - RESTful API配置管理
   - Element UI组件渲染

### 边界限制

**MVP范围内**：

- ✅ 单直播间弹幕抓取
- ✅ 基础语音转录
- ✅ 简单情感分析
- ✅ 桌面端展示界面

**暂不实现**：

- ❌ 多直播间同时监控
- ❌ 复杂AI模型训练
- ❌ 用户账号系统
- ❌ 移动端支持

### 技术依赖

```python
# 核心依赖
f2 >= 0.0.1.7  # 抖音数据抓取
vosk >= 0.3.45  # 语音识别
fastapi >= 0.100.0  # Web框架
websockets >= 11.0  # WebSocket支持
jieba >= 0.42.1  # 中文分词
snownlp >= 0.12.3  # 情感分析
```

### 风险评估

| 风险项                | 级别 | 应对方案                         |
| --------------------- | ---- | -------------------------------- |
| F2项目更新导致API变化 | 中   | 锁定稳定版本，监控更新           |
| VOSK中文识别准确率    | 中   | 测试验证，准备在线API备选        |
| 3天开发时间紧张       | 高   | 严格按任务分解执行，优先核心功能 |
| 抖音平台反爬升级      | 低   | F2项目持续维护，社区响应快       |

### 成功标准

1. **技术指标**：

   - 弹幕抓取成功率 > 95%
   - 语音转录延迟 < 5秒
   - 系统运行稳定无崩溃
2. **用户体验**：

   - 界面响应流畅
   - 数据展示实时准确
   - 操作简单易懂
3. **MVP验证**：

   - 完整演示流程
   - 获得5-10个测试用户反馈
   - 验证核心价值假设

---

**共识确认**：

- ✅ 技术栈选型合理，能够支撑MVP需求
- ✅ F2项目成熟可靠，是最佳的抖音数据抓取方案
- ✅ VOSK本地化优势明显，适合成本控制
- ✅ 3天开发计划可行，风险可控
- ✅ 验收标准明确，可量化测试

**下一步**：进入架构设计阶段 (Architect)
